close all; clear all; clc;


% addpath('../funciones_varias');
% addpath(genpath('../MatlabScript'));
%% generacion de la señal
f=100;
fs=22050;
L=2048;
Lword=32;  % Q31

signal = signalforMU_file(f,fs,L,Lword);
%plot(signal);
signal=signal*(2^32)*0.99;
%% establezco comunicación serie
% para ver el puerto, en la consola dmesg

srl = serial('/dev/ttyUSB0','BaudRate',9600,'DataBits',8,'StopBits',1);
fopen(srl);

for h=1:size(signal,2)
    fwrite(srl,int32(signal(h)),'int32','sync');
    h
end
plot(signal);
%  fclose(srl);
%  delete(srl);
%  clear srl;
% plot(signal);

%% interpretacion de datos
display('ahi vienen los indios')
resultados=fread(srl);
Y = typecast(resultados, 'int32'); % agrupo de a 4 bytes
Ym= dec2hex(Y)
figure('name','resultados');
plot(Y);

